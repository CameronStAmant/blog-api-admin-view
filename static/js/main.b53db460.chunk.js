(this["webpackJsonpadmin-view"]=this["webpackJsonpadmin-view"]||[]).push([[0],{28:function(e,t,r){},29:function(e,t,r){},38:function(e,t,r){"use strict";r.r(t);var n=r(1),o=r.n(n),s=r(19),c=r.n(s),a=(r(28),r(2)),i=r(5),d=r(3),l=(r(29),r(6)),u=r.n(l),b=r(10),j=r(0),h=function(e){return Object(j.jsx)("div",{className:"display: grid grid-cols-3 col-span-3 row-start-1 bg-green-100 py-2",children:Object(j.jsxs)("ul",{className:"display: grid col-start-1 col-span-full grid-flow-col place-items-center text-center",children:[Object(j.jsx)("li",{className:"border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-5/6 active:bg-green-400 active:border-green-400 shadow-sm",children:Object(j.jsx)(i.c,{to:"/",className:"display: block",children:"Home"})}),!e.authState&&Object(j.jsx)("li",{className:"sm:col-start-3 lg:col-start-4 bordber-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-5/6 active:bg-green-400 active:border-green-400 shadow-sm",children:Object(j.jsx)(i.c,{to:"/login",className:"display: block",children:"Login"})}),e.authState&&Object(j.jsx)("li",{className:"sm:col-start-4 lg:col-start-5 border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-5/6 active:bg-green-400 active:border-green-400 shadow-sm",children:Object(j.jsx)(i.c,{to:"/logout",className:"display: block",children:"Log out"})})]})})},m=function(){return Object(j.jsxs)("ul",{className:"display: grid grid-cols-3 text-center py-2 row-start-3 col-span-full",children:[Object(j.jsx)("li",{children:"Privacy"}),Object(j.jsx)("li",{children:"About"}),Object(j.jsx)("li",{children:"Contact us"})]})},g=function(e){return Object(j.jsxs)("div",{className:"display: grid grid-cols-3 grid-rows-layout min-h-screen grid-flow-col p-0 m-0 list-none",children:[Object(j.jsx)(h,{authState:e.authState}),e.children,Object(j.jsx)(m,{})]})},p="https://serene-waters-04286.herokuapp.com",f=function(e){var t=Object(n.useState)(null),r=Object(a.a)(t,2),o=r[0],s=r[1],c=Object(n.useState)(!1),l=Object(a.a)(c,2),h=l[0],m=l[1],f=(Object(d.g)(),function(e,t){e.preventDefault();var r=new FormData;r.append("title",t.title),r.append("body",t.body),r.append("published",!t.published),r.append("coverPhoto",t.coverPhoto);var n={method:"PUT",mode:"cors",headers:{Authorization:"Bearer "+localStorage.getItem("user")},body:r};fetch(p+"/posts/"+t.id,n).then((function(e){m(!h)}))});return Object(n.useEffect)((function(){(function(){var e=Object(b.a)(u.a.mark((function e(){var t,r,n,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p+"/posts",{mode:"cors"});case 2:return t=e.sent,e.next=5,t.json();case 5:r=e.sent,n=r.posts,o=n.map((function(e){return Object(j.jsxs)("li",{className:"display: grid box-border border-2 shadow-sm rounded-md gap-4 border-green-200 mx-2 auto-rows-min",children:[Object(j.jsxs)(i.b,{to:"/posts/"+e.id,children:[Object(j.jsx)("img",{src:e?p+"/uploads/"+e.coverPhoto:"",alt:"Post Cover"}),Object(j.jsx)("p",{className:"m-14 text-center text-xl font-semibold",children:e.title})]}),Object(j.jsxs)("div",{className:"display: grid mb-8",children:[Object(j.jsxs)("p",{children:["Published: ",e.published.toString()]}),Object(j.jsx)("form",{onSubmit:function(t){return f(t,e)},children:Object(j.jsx)("input",{className:"border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-2/6 active:bg-green-400 active:border-green-400 shadow-sm",type:"submit",id:"togglePublish",value:"Toggle"})})]})]},e.title)})),s(o);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[h]),Object(j.jsx)(g,{authState:e.authState,children:Object(j.jsxs)("div",{className:"display: grid grid-rows-home auto-rows-min row-start-2 col-span-full",children:[Object(j.jsxs)("div",{className:"row-start-1 place-self-center min-h-px col-span-full text-2xl font-semibold text-center",children:[Object(j.jsx)("h2",{children:"Welcome to the blog admin site!"}),Object(j.jsx)(i.b,{to:"/posts/new",children:Object(j.jsx)("button",{type:"button",className:"border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-2/6 active:bg-green-400 active:border-green-400 shadow-sm",children:"New Post"})})]}),Object(j.jsx)("ul",{className:"display: grid grid-flow-row md:grid-cols-2 row-start-2 lg:grid-cols-3 col-span-full gap-y-4 h-full text-center auto-rows-min",children:o||""})]})})};var O=function(e){return Object(j.jsx)("div",{children:Object(j.jsx)(f,{authState:e.authState})})},x=function(e){var t=Object(n.useState)(null),r=Object(a.a)(t,2),o=r[0],s=r[1],c=Object(n.useState)(null),i=Object(a.a)(c,2),l=i[0],u=i[1],b=Object(d.g)(),h=Object(n.useState)(null),m=Object(a.a)(h,2),f=m[0],O=m[1];return Object(j.jsx)(g,{children:Object(j.jsx)("div",{className:"display: grid col-start-1 grid-rows-6 col-span-full row-start-2 place-content-center",children:Object(j.jsxs)("form",{onSubmit:function(t){t.preventDefault();var r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,password:l,adminSite:!0})};fetch(p+"/login",r).then((function(e){return e.json()})).then((function(t){void 0!==t.token?(window.localStorage.setItem("user",t.token),e.authRefresh(!0),b.push("/")):O(t.message)}))},className:"text-center row-start-3",children:[Object(j.jsx)("label",{htmlFor:"username-field",children:"Username:"}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{className:" input w-48 border-2 border-green-200 rounded-md  focus:border-green-500",type:"text",id:"username-field",name:"username",autoComplete:"on",value:o||"",onChange:function(e){return s(e.target.value)},required:!0}),Object(j.jsx)("br",{}),Object(j.jsx)("label",{htmlFor:"password-field",children:"Password:"}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{className:" input w-48 border-2 border-green-200 rounded-md  focus:border-green-500",type:"password",id:"password-field",name:"password",autoComplete:"on",value:l||"",onChange:function(e){return u(e.target.value)},required:!0}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{className:" bg-green-100 rounded-md mt-2 w-48 hover:bg-green-200 cursor-pointer",type:"submit",id:"loginButton",value:"Login"}),f&&Object(j.jsx)("p",{className:"row-start-4",children:f})]})})})},v=function(e){return Object(n.useEffect)((function(){e.authRefresh(!0),window.localStorage.removeItem("user")}),[]),Object(j.jsx)("div",{children:!e.authState&&Object(j.jsx)(d.a,{to:"/login"})})},w=r(23),y=r(22),S=r(37).DateTime,N=function(e){var t=Object(n.useState)([]),r=Object(a.a)(t,2),o=r[0],s=r[1],c=Object(n.useState)(!1),d=Object(a.a)(c,2),l=d[0],h=d[1],m=function(t,r){t.preventDefault();var n={method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("user")}};fetch(p+"/posts/"+e.postid+"/comments/"+r,n).then((function(){s([]),h(!l)}))},g=function(){var t=Object(b.a)(u.a.mark((function t(){var r,n,o,c,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(p+"/posts/"+e.postid+"/comments",{mode:"cors"});case 2:return r=t.sent,t.next=5,r.json();case 5:n=t.sent,o=Object(y.a)(n.comments);try{for(a=function(){var t,r=c.value;t=Object(j.jsxs)("div",{className:"box-border border-solid m-2 shadow-md p-1 display: grid gap-2 grid-rows-2 grid-cols-2 auto-rows-min-content justify-self-stretch border-2 border-green-200 rounded-md ",id:r._id,children:[Object(j.jsx)("h4",{className:"justify-self-start",children:r.author.username}),Object(j.jsx)("p",{className:"justify-self-end",children:S.fromISO(r.timestamp).toLocaleString(S.DATETIME_MED)}),Object(j.jsx)("p",{className:"row-start-2 col-span-full",children:r.body}),Object(j.jsxs)("div",{className:"justify-self-end space-x-3 col-start-2",children:[Object(j.jsx)(i.b,{to:"/posts/"+e.postid+"/comments/"+r._id+"/edit",children:Object(j.jsx)("button",{type:"button",className:"border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-auto active:bg-green-400 active:border-green-400 shadow-sm",children:"Edit"})}),Object(j.jsx)("button",{type:"button",className:"border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-auto active:bg-green-400 active:border-green-400 shadow-sm",onClick:function(e){return m(e,r._id)},children:"Delete"})]})]},r._id),s((function(e){return[].concat(Object(w.a)(e),[t])}))},o.s();!(c=o.n()).done;)a()}catch(d){o.e(d)}finally{o.f()}case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){g()}),[l]),Object(j.jsx)("div",{className:"justify-self-stretch my-14",children:o})},I=function(e){var t=Object(n.useState)(null),r=Object(a.a)(t,2),o=r[0],s=r[1],c=Object(d.i)().id,l=Object(d.g)();return Object(n.useEffect)((function(){(function(){var e=Object(b.a)(u.a.mark((function e(){var t,r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p+"/posts/"+c,{mode:"cors"});case 2:return t=e.sent,e.next=5,t.json();case 5:r=e.sent,n=r.post,s(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[c]),Object(j.jsx)(g,{authState:e.authState,children:Object(j.jsxs)("div",{className:"display: grid grid-rows-post auto-rows-auto row-start-2 col-span-full",children:[Object(j.jsxs)("div",{className:"display: grid grid-rows-postTitle",children:[Object(j.jsxs)("div",{className:"row-start-1 place-self-center col-span-full text-2xl font-semibold text-center display: grid",children:[Object(j.jsx)("h2",{children:o?o.title:""}),Object(j.jsx)("div",{children:Object(j.jsxs)("div",{className:"space-x-3",children:[Object(j.jsx)(i.b,{to:Object(d.h)().pathname+"/edit",children:Object(j.jsx)("button",{type:"button",className:"border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-auto active:bg-green-400 active:border-green-400 shadow-sm",children:"Edit"})}),Object(j.jsx)("button",{type:"button",className:"border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-auto active:bg-green-400 active:border-green-400 shadow-sm",onClick:function(e){e.preventDefault();var t={method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("user")},body:JSON.stringify({post:c})};fetch(p+"/posts/"+c,t).then((function(){l.push("/")}))},children:"Delete"})]})})]}),Object(j.jsx)("img",{src:o?p+"/uploads/"+o.coverPhoto:"",alt:"cover"}),Object(j.jsxs)("p",{className:"mx-2 px-1",children:[" ",o?o.body:""]})]}),Object(j.jsx)(N,{postid:c})]})})},P=function(e){var t=Object(n.useState)(null),r=Object(a.a)(t,2),o=r[0],s=r[1],c=Object(n.useState)(null),i=Object(a.a)(c,2),l=i[0],h=i[1],m=Object(n.useState)(null),f=Object(a.a)(m,2),O=f[0],x=f[1],v=Object(n.useState)(null),w=Object(a.a)(v,2),y=w[0],S=w[1],N=Object(n.useState)(!1),I=Object(a.a)(N,2),P=I[0],C=I[1],E=Object(n.useState)(null),T=Object(a.a)(E,2),D=T[0],k=T[1],B=Object(d.i)().id,A=function(e){e.preventDefault(),null===O?(h(e.target.files[0]),x(URL.createObjectURL(e.target.files[0]))):x(null)};return Object(n.useEffect)((function(){void 0===B||function(){var e=Object(b.a)(u.a.mark((function e(){var t,r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p+"/posts/"+B+"/edit",{mode:"cors",headers:{Authorization:"Bearer "+localStorage.getItem("user")}});case 2:return t=e.sent,e.next=5,t.json();case 5:r=e.sent,n=r.post,console.log(n),s(n.title),h(n.coverPhoto),x(p+"/uploads/"+n.coverPhoto),S(n.body);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[B]),Object(j.jsxs)(g,{authState:e.authState,children:[null!==D&&Object(j.jsx)(d.a,{to:D}),!0===P&&null===D&&Object(j.jsx)(d.a,{from:"/posts/:id/edit",to:"/posts/"+B}),Object(j.jsx)("div",{className:"justify-self-stretch col-span-full row-start-2 h-full",children:Object(j.jsxs)("form",{className:"mt-14 mx-2 text-center",onSubmit:function(t){if(t.preventDefault(),void 0===B){var r=new FormData;r.append("author",e.userId),r.append("title",o),r.append("body",y),r.append("coverPhoto",l);var n={method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("user")},body:r};fetch(p+"/posts/",n).then((function(e){return e.json()})).then((function(e){return k(e.url)})).catch((function(e){console.log("The fetch error is: "+e)}))}else{var s=new FormData;s.append("title",o),s.append("body",y),s.append("coverPhoto",l);var c={method:"PUT",headers:{Authorization:"Bearer "+localStorage.getItem("user")},body:s};fetch(p+"/posts/"+B,c).then((function(){return C(!0)}))}},children:[Object(j.jsx)("label",{children:"Title: "}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{className:"box-border border-2 shadow-sm rounded-md gap-4 border-green-200 auto-rows-min w-full",type:"text",name:"title",value:o||"",onChange:function(e){return s(e.target.value)},required:!0}),Object(j.jsx)("br",{}),Object(j.jsx)("label",{children:"Cover photo"}),Object(j.jsx)("br",{}),O&&Object(j.jsxs)("div",{children:[Object(j.jsx)("img",{src:O,alt:"Cover"}),Object(j.jsx)("button",{onClick:function(e){return A(e)},children:"Remove Image"})]}),null===O&&Object(j.jsx)("input",{className:"",type:"file",name:"coverPhoto",id:"coverPhoto",v:!0,onChange:function(e){return A(e)},required:!0}),Object(j.jsx)("br",{}),Object(j.jsx)("label",{children:"Body: "}),Object(j.jsx)("br",{}),Object(j.jsx)("textarea",{className:"box-border border-2 shadow-sm rounded-md gap-4 border-green-200 auto-rows-min w-full h-screen",rows:"20",name:"body",value:y||"",onChange:function(e){return S(e.target.value)},required:!0}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{type:"submit",className:"border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-2/6 active:bg-green-400 active:border-green-400 shadow-sm",value:"Submit"})]})})]})},C=function(e){var t=Object(n.useState)(null),r=Object(a.a)(t,2),o=r[0],s=r[1],c=Object(d.i)(),i=c.id,l=c.commentId,h=Object(d.g)();return Object(n.useEffect)((function(){(function(){var e=Object(b.a)(u.a.mark((function e(){var t,r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p+"/posts/"+i+"/comments/"+l+"/edit",{mode:"cors",headers:{Authorization:"Bearer "+localStorage.getItem("user")}});case 2:return t=e.sent,e.next=5,t.json();case 5:r=e.sent,n=r.comment,s(n.body);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[i,l]),Object(j.jsx)(g,{authState:e.authState,children:Object(j.jsx)("div",{className:"justify-self-stretch gap-4 col-span-full row-start-2",children:Object(j.jsxs)("form",{className:"mt-14 mx-2 text-center h-auto",onSubmit:function(e){e.preventDefault();var t={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("user")},body:JSON.stringify({body:o})};fetch(p+"/posts/"+i+"/comments/"+l,t).then((function(){h.push("/posts/"+i)}))},children:[Object(j.jsx)("label",{children:"Body: "}),Object(j.jsx)("br",{}),Object(j.jsx)("textarea",{className:"box-border border-2 shadow-sm rounded-md gap-4 border-green-200 auto-rows-min w-full",rows:"20",name:"body",value:o||"",onChange:function(e){return s(e.target.value)},required:!0}),Object(j.jsx)("input",{type:"submit",id:"commentSubmit",className:"border-solid border-4 border-green-200 rounded-md bg-green-200 hover:bg-green-300 hover:border-green-300 w-2/6 active:bg-green-400 active:border-green-400 shadow-sm",value:"Submit"})]})})})},E=function(){var e=Object(n.useState)(!1),t=Object(a.a)(e,2),r=t[0],o=t[1],s=Object(n.useState)(null),c=Object(a.a)(s,2),l=c[0],u=c[1],b=Object(n.useState)(!1),h=Object(a.a)(b,2),m=h[0],g=h[1];return Object(n.useEffect)((function(){!function(){var e={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("user")}};localStorage.getItem("user")?fetch(p+"/auth",e).then((function(e){return e.json()})).then((function(e){o(e.response),u(e.userId),g(!1)})):(o(!1),u(null),g(!1))}()}),[m]),Object(j.jsxs)(i.a,{forceRefresh:!0,children:[!r&&!localStorage.getItem("user")&&Object(j.jsx)("div",{children:Object(j.jsxs)(d.d,{children:[Object(j.jsx)(d.b,{exact:!0,path:"/",render:function(){return Object(j.jsx)(x,{authRefresh:function(e){return g(e)}})}}),Object(j.jsx)(d.b,{exact:!0,path:"/login",render:function(){return Object(j.jsx)(x,{authRefresh:function(e){return g(e)}})}}),Object(j.jsx)(d.a,{to:"/login"})]})}),r&&localStorage.getItem("user")&&Object(j.jsxs)(d.d,{children:[Object(j.jsx)(d.b,{exact:!0,path:"/",render:function(){return Object(j.jsx)(O,{authState:r})}}),Object(j.jsx)(d.b,{exact:!0,path:"/login",render:function(){return Object(j.jsx)(x,{authRefresh:function(e){return g(e)}})}}),Object(j.jsx)(d.b,{exact:!0,path:"/logout",render:function(){return Object(j.jsx)(v,{authState:r,authRefresh:function(e){return g(e)}})}}),Object(j.jsx)(d.b,{exact:!0,path:"/posts/new",render:function(){return Object(j.jsx)(P,{authState:r,userId:l})}}),Object(j.jsx)(d.b,{exact:!0,path:"/posts/:id",render:function(){return Object(j.jsx)(I,{authState:r})}}),Object(j.jsx)(d.b,{exact:!0,path:"/posts/:id/edit",render:function(){return Object(j.jsx)(P,{authState:r})}}),Object(j.jsx)(d.b,{exact:!0,path:"/posts/:id/comments/:commentId/edit",render:function(){return Object(j.jsx)(C,{authState:r})}})]})]})};c.a.render(Object(j.jsx)(o.a.StrictMode,{children:Object(j.jsx)(E,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.b53db460.chunk.js.map